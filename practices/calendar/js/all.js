"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),Calendar=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"body";_classCallCheck(this,t),this.parent=document.querySelector(e),this.year=(new Date).getFullYear(),this.month=(new Date).getMonth()+1,this.monthData=null,this.isOpen=!1,this.oInput=null,this.init()}return _createClass(t,[{key:"init",value:function(){this.monthData=this.getMounthData(this.year,this.month),this.build(this.monthData),this.updateEvent()}},{key:"build",value:function(t){var e=this.rendDate(t),n='\n\t\t<input class="datepicker" type="text" name="input">\n\t\t\t<div class="picker">\n\t\t\t\t<div class="picker-header">\n\t\t\t\t\t<div class="year">\n\t\t\t\t\t\t<span class="btn year-pre">&lt;</span>\n\t\t\t\t\t\t<span class="year-current">'+this.year+'年</span>\n\t\t\t\t\t\t<span class="btn year-next">&gt;</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="month">\n\t\t\t\t\t\t<span class="btn month-pre">&lt;</span>\n\t\t\t\t\t\t<span class="month-current">'+this.month+'月</span>\t\n\t\t\t\t\t\t<span class="btn month-next">&gt;</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="picker-body">\n\t\t\t\t\t<div class="picker-day">\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<li>日</li>\n\t\t\t\t\t\t\t<li>一</li>\n\t\t\t\t\t\t\t<li>二</li>\n\t\t\t\t\t\t\t<li>三</li>\n\t\t\t\t\t\t\t<li>四</li>\n\t\t\t\t\t\t\t<li>五</li>\n\t\t\t\t\t\t\t<li>六</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="picker-date">\n\t\t\t\t\t\t'+e+"\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t";this.parent.innerHTML=n}},{key:"getMounthData",value:function(t,e){var n=[],a=new Date(t,e-1,1).getDay();0===a&&(a=7);for(var i=new Date(t,e-1,0).getDate(),s=a-1,r=new Date(t,e,0).getDate(),h=0;h<42;h++){var o=h-s,l=o,c=e;o<=0?(c=e-1,l=i+o):o>r&&(c=e+1,l-=r),0===c&&(c=12),13===c&&(c=1),n.push({month:c,date:o,showDate:l})}return{year:t,month:e,days:n}}},{key:"updateEvent",value:function(){var t=this.parent.querySelector(".year-pre"),e=this.parent.querySelector(".year-next"),n=this.parent.querySelector(".month-pre"),a=this.parent.querySelector(".month-next"),i=this.parent.querySelector(".picker-date");this.oInput=this.parent.querySelector(".datepicker"),t.onclick=this.changeYear.bind(this,-1),e.onclick=this.changeYear.bind(this,1),n.onclick=this.changeMonth.bind(this,-1),a.onclick=this.changeMonth.bind(this,1),i.onclick=this.pickerDate.bind(this),this.oInput.onclick=this.picker.bind(this)}},{key:"changeYear",value:function(t){this.year+=t,this.monthData=this.getMounthData(this.year,this.month),this.render(this.monthData)}},{key:"changeMonth",value:function(t){this.month+=t,13===this.month&&(this.month=1,this.year+=1),0===this.month&&(this.month=12,this.year-=1),this.monthData=this.getMounthData(this.year,this.month),this.render(this.monthData)}},{key:"picker",value:function(t){if(this.isOpen)this.parent.querySelector(".picker").classList.remove("picker-show"),this.isOpen=!1;else{this.parent.querySelector(".picker").classList.add("picker-show");var e=t.target.offsetLeft,n=t.target.offsetTop,a=t.target.offsetHeight;this.parent.querySelector(".picker").style.left=e+"px",this.parent.querySelector(".picker").style.top=n+a+"px",this.isOpen=!0}}},{key:"pickerDate",value:function(t){var e=t.target;e.classList.contains("disable")||(this.parent.querySelector(".picker").classList.remove("picker-show"),this.oInput.value=this.format(e.dataset.date),this.isOpen=!1)}},{key:"render",value:function(t){var e=this.rendDate(t),n=this.parent.querySelector(".picker-date"),a=this.parent.querySelector(".year-current"),i=this.parent.querySelector(".month-current");n.innerHTML=e,a.innerHTML=this.year+"年",i.innerHTML=this.month+"月"}},{key:"rendDate",value:function(t){for(var e="",n=0;n<t.days.length/7;n++){for(var a="",i=0;i<7;i++){var s=t.days[i+7*n].showDate;t.month==t.days[i+7*n].month?a+='<li data-date="'+t.days[i+7*n].date+'">'+s+"</li>":a+='<li class="disable" data-date="'+t.days[i+7*n].date+'">'+s+"</li>"}e+="<ul>"+a+"</ul>"}return e}},{key:"format",value:function(t){return this.monthData.year+"-"+this.monthData.month+"-"+t}}]),t}();